<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate cutpoints of metric variables in the context of Cox-regression • cutpoint</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate cutpoints of metric variables in the context of Cox-regression">
<meta property="og:description" content="Estimate one or two cutpoints of a metric or ordinal-scaled variable in the multivariable context of survival data or time-to-event data. Visualise the cutpoint estimation process using contour plots, index plots, and spline plots. It is also possible to estimate cutpoints based on the assumption of a U-shaped or inverted U-shaped relationship between the predictor and the hazard ratio.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">cutpoint</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jan-por/cutpoint/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="cutpoint-">cutpoint <img src="reference/figures/logo.png" align="right" width="91"><a class="anchor" aria-label="anchor" href="#cutpoint-"></a>
</h1></div>
<ul>
<li><p>Estimate one or two cutpoints of a variable of interest in the multivariable context of survival data or time-to-event data</p></li>
<li><p>Visualise the cutpoint estimation process using contour plots, index plots, and spline plots</p></li>
<li><p>Estimate cutpoints based on the assumption of a U-shaped or inverted U-shaped relationship between the predictor and the hazard ratio</p></li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of cutpoint from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu">pak</span><span class="op">(</span><span class="st">"jan-por/cutpoint"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>The R package <code>cutpoint</code> is used to determine cutpoints of variables, such as biomarkers, in the multivariable context of survival or time-to-event analyses. These cutpoints are applied to form groups with different probabilities of an event occurring.</p>
<p>For example, in medical research, cutpoints of biomarkers are formed to classify patients into different risk groups regarding survival in tumor diseases. Using the R package <code>cutpoint</code>, it is possible to estimate one or two cutpoints for categorising a variable of interest, while taking other relevant variables into account. Thus, it is possible, for instance in the medical context, not only to estimate a cutpoint based on a single biomarker but also to consider other biomarkers or baseline characteristics.</p>
<p>The R packet cutpoint allows for a combined approach to determining cutpoints, particularly through numerical calculations and visual examination of different plots according to their functional forms.</p>
<p>For the numerical calculation, either the AIC (Akaike Information Criterion) or the LRT (Likelihood-Ratio Test statistic) is used to estimate the cutpoint in the context of Cox-regression. The Likelihood Ratio Test statistic is calculated by taking the scaled difference between the log-likelihoods of the model and the null model’s log-likelihoods. Details on the methods can be found in the article by Govindarajulu, U., &amp; Tarpey, T. (2022). Optimal partitioning for the proportional hazards model. Journal of Applied Statistics, 49(4), 968–987. <a href="https://doi.org/10.1080/02664763.2020.1846690" class="external-link uri">https://doi.org/10.1080/02664763.2020.1846690</a></p>
<p>The <code>cp_est</code> function estimates one or two cutpoints for a biomarker. The argument <code>ushape</code> enables cutpoints to be estimated assuming the splines plot displays a U-shaped or inverted U-shaped curve. The <code>symtail</code> argument allows for the estimation of two cutpoints, ensuring that the two outer tails represent groups of approximately the same size.</p>
<hr>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p><strong>Estimate one cutpoint of the variable biomarker under consideration of two other covariates.</strong></p>
<p>For this example, the dataset <code>data1</code>, included in the R-package <code>cutpoint</code>, is used. It has 100 observations and contains the variables:</p>
<ul>
<li>time, event, biomarker, covariate_1, and covariate_2</li>
</ul>
<p>Because one cutpoint should be estimated, the argument <code>nb_of_cp</code> is set to 1. (<code>nb_of_cp = 1</code>)</p>
<p>For the other arguments, their default settings are used:</p>
<ul>
<li><p>Min. group size in % <code>bandwidth = 0.1</code></p></li>
<li><p>Estimation type <code>est_type = "AIC"</code></p></li>
<li><p>Cutpoint variable as strata in Cox model? <code>cpvar_strata = FALSE</code> (not as strata)</p></li>
<li><p>Symmetric tails <code>symtails = FALSE</code></p></li>
<li><p>Cutpoints for u-shape <code>ushape = FALSE</code></p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jan-por/cutpoint" class="external-link">cutpoint</a></span><span class="op">)</span> </span>
<span><span class="va">cpobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cp_est.html">cp_est</a></span><span class="op">(</span></span>
<span>   cpvarname <span class="op">=</span> <span class="st">"biomarker"</span>, </span>
<span>   covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariate_1"</span>, <span class="st">"covariate_2"</span><span class="op">)</span>, </span>
<span>   data <span class="op">=</span> <span class="va">data1</span>, </span>
<span>   nb_of_cp <span class="op">=</span> <span class="fl">1</span></span>
<span>   <span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="output">Output:<a class="anchor" aria-label="anchor" href="#output"></a>
</h4>
<p>The output displays the primary settings and the cutpoint:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; Approx. remaining time for estimation: 0 seconds </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; SETTINGS:</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt;  Cutpoint-variable                    =  biomarker </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;  Number of cutpoints   (nb_of_cp)     =  1 </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;  Min. group size in %  (bandwith)     =  0.1 </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;  Estimation type       (est_type)     =  AIC </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;  CP-variable as strata (cpvar_strata) =  FALSE </span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;  Symmetric tails       (symtails)     =  FALSE   (is set to FALSE if nb_of_cp = 1)</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;  Cutpoints for u-shape (ushape)       =  FALSE   (is set to FALSE if nb_of_cp = 1)</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; Covariates or factors are:</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt;   covariate_1 covariate_2 </span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; Minimum group size is 10 (10% of sample size in original dataset, N = 100)</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt; Number of cutpoints searching for: 1 </span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt; Cutpoint: biomarker ≤ 89 </span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------------------------</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt; Group size in relation to valid data of biomarker in original data set</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt;  Total:   N = 100 (100%)</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt;  Group A: n = 12 (12%)</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt;  Group B: n = 88 (88%)</span></span></code></pre></div>
<p>The argument <code>bandwidth</code> can change the minimum group sizes and may lead to different cutpoint estimates.</p>
<hr>
<p>Other cutpoints may be estimated if no covariates (<code>covariates = NULL</code>) are included in the cutpoint search:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jan-por/cutpoint" class="external-link">cutpoint</a></span><span class="op">)</span></span>
<span><span class="va">cpobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cp_est.html">cp_est</a></span><span class="op">(</span></span>
<span>   cpvarname <span class="op">=</span> <span class="st">"biomarker"</span>, </span>
<span>   covariates <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>   data <span class="op">=</span> <span class="va">data1</span>, </span>
<span>   nb_of_cp <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="output-1">Output:<a class="anchor" aria-label="anchor" href="#output-1"></a>
</h4>
<p>With covariates, the cutpoint was ≤ 89; without covariates the cutpoint is ≤ 137:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; Approx. remaining time for estimation: 0 seconds </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; SETTINGS:</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;  Cutpoint-variable                    =  biomarker </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;  Number of cutpoints   (nb_of_cp)     =  1 </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;  Min. group size in %  (bandwith)     =  0.1 </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;  Estimation type       (est_type)     =  AIC </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;  CP-variable as strata (cpvar_strata) =  FALSE </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt;  Symmetric tails       (symtails)     =  FALSE   (is set to FALSE if nb_of_cp = 1)</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt;  Cutpoints for u-shape (ushape)       =  FALSE   (is set to FALSE if nb_of_cp = 1)</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; No covariates were selected</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; Minimum group size is 10 (10% of sample size in original dataset, N = 100)</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; Number of cutpoints searching for: 1 </span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; Cutpoint: biomarker ≤ 137 </span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------------------------</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; Group size in relation to valid data of biomarker in original data set</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt;  Total:   N = 100 (100%)</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt;  Group A: n = 29 (29%)</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt;  Group B: n = 71 (71%)</span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="visual-evaluation-of-possible-cutpoints">Visual evaluation of possible cutpoints<a class="anchor" aria-label="anchor" href="#visual-evaluation-of-possible-cutpoints"></a>
</h3>
<p>The <code>cp_value_plot</code> and <code>cp_splines_plot</code> functions are utilised to choose the appropriate cutpoints.</p>
<p>The default plot of the function <code>cp_est</code> is a covariate-adjusted splines plot with different degrees of freedom. This plot can also be generated using the function <code>cp_splines_plot</code>, which enables the creation of covariate-adjusted or non-adjusted splines plots.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/cp_splines_plot.html">cp_splines_plot</a></span><span class="op">(</span><span class="va">cpobj</span>, show_splines <span class="op">=</span> <span class="cn">TRUE</span>, adj_splines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<figure><img src="reference/figures/cutpoint-package_splines_plot_with_different_degrees_of_freedom.png" alt="Figure 1. Covariate-adjusted splines with different degrees of freedom (df)"><figcaption aria-hidden="true">
Figure 1. Covariate-adjusted splines with different degrees of freedom (df)
</figcaption></figure><p> </p>
<p>The cutpoint is shown as a vertical red line, while the dashed red line represents the mean of the variable of interest. The first quartile, median, and third quartile are indicated in grey. The lines, which are based on different degrees of freedom should facilitate in determining, whether misspecification or overfitting occurs. The former example does not appear to be one of those. Therefore the function <code>cp_splines_plot</code> can be used with the argument <code>show_splines = FALSE</code> to obtain a clearer illustration:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/cp_splines_plot.html">cp_splines_plot</a></span><span class="op">(</span><span class="va">cpobj</span>, show_splines <span class="op">=</span> <span class="cn">FALSE</span>, adj_splines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<figure><img src="reference/figures/cutpoint-package_splines_plot_with_optimal_degrees_of_freedom.png" alt="Figure 2. Covariate-adjusted splines plot with optimal degrees of freedom"><figcaption aria-hidden="true">
Figure 2. Covariate-adjusted splines plot with optimal degrees of freedom
</figcaption></figure><hr>
</div>
</div>
<div class="section level2">
<h2 id="contour-plots-and-index-plots">
<strong>Contour plots and Index plots</strong><a class="anchor" aria-label="anchor" href="#contour-plots-and-index-plots"></a>
</h2>
<p>The function <code>cp_value_plot</code> enables the creation of contour plots and index plots from a <code>cpobj</code> Object. The AIC values of the cutpoint estimation process or the Likelihood Ratio Test statistic (LRT) statistic can be used for this.</p>
<div class="section level4">
<h4 id="contour-plot">
<strong>Contour plot</strong><a class="anchor" aria-label="anchor" href="#contour-plot"></a>
</h4>
<p><strong>Example</strong>: Estimate two cutpoints of the variable biomarker under consideration of two other covariates:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jan-por/cutpoint" class="external-link">cutpoint</a></span><span class="op">)</span> </span>
<span><span class="va">cpobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cp_est.html">cp_est</a></span><span class="op">(</span></span>
<span>   cpvarname <span class="op">=</span> <span class="st">"biomarker"</span>, </span>
<span>   covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariate_1"</span>, <span class="st">"covariate_2"</span><span class="op">)</span>, </span>
<span>   data <span class="op">=</span> <span class="va">data1</span>, </span>
<span>   nb_of_cp <span class="op">=</span> <span class="fl">2</span></span>
<span>   <span class="op">)</span></span></code></pre></div>
<p><strong>Call plot:</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/cp_value_plot.html">cp_value_plot</a></span><span class="op">(</span><span class="va">cpobj</span>, plotvalues <span class="op">=</span> <span class="st">"AIC"</span>, plottype2cp <span class="op">=</span> <span class="st">"contour"</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<figure><img src="reference/figures/cutpoint-package_value_plot_two_cutpoints.png" width="1000" height="500" alt="Figure 3. Contour plot shows coloured AIC value areas and potential cutpoints"><figcaption aria-hidden="true">
Figure 3. Contour plot shows coloured AIC value areas and potential cutpoints
</figcaption></figure><p> </p>
<p>The x-axis and y-axis represent potential cutpoint values, while the AIC values from the estimation process are coloured. The lowest AIC values are shown in dark colours and may indicate potential cutpoints. The estimated cutpoints are: Cutpoint 1 ≤ 89 and Cutpoint 2 ≤ 137 (marked).</p>
<p> <br>
The next plot (Figure 4) illustrates another example of a biomarker from another virtual dataset, identifying two possible cutpoint combinations. The AIC values differ only slightly (3558.3 vs 3558.2). From a statistical point of view, both cutpoint combinations may be acceptable. However, perhaps one of the two options is more reasonable from a scientific perspective. Therefore, it is beneficial to utilise the output in the console and examine the plots.<br>
 </p>
<figure><img src="reference/figures/cutpoint-package_value_plot_two_cutpoints_v2-1.png" alt="Figure 4. Contour plot shows coloured AIC value areas and two potential combination of cutpoints"><figcaption aria-hidden="true">
Figure 4. Contour plot shows coloured AIC value areas and two potential combination of cutpoints
</figcaption></figure><p> <br>
The smaller the <code>bandwidth</code> (minimum group size per group), the more precise and meaningful the contour plots can be interpreted.</p>
</div>
<div class="section level4">
<h4 id="index-plot">Index plot<a class="anchor" aria-label="anchor" href="#index-plot"></a>
</h4>
<p>The index plot below is based on the same example used for Figure 4. The x-axis represents the index of all possible combinations for the two cutpoints being searched for. In this case, there are more than 60.000. As Figure 4 already shows, and Figure 5 indicates, two areas have lower AIC values (marked).<br>
 </p>
<figure><img src="reference/figures/cutpoint-package_index_plot_2_cutpoints_v2.png" alt="Figure 5. Index plot - shows AIC values and the index of all possible combinations for the two cutpoints being searched for"><figcaption aria-hidden="true">
Figure 5. Index plot - shows AIC values and the index of all possible combinations for the two cutpoints being searched for
</figcaption></figure><p> <br>
Index plots that do not show clear areas with extreme values, as illustrated in Figure 5, suggest that a real cutpoint may not exist in the data. However, even if there is no true cutpoint in the data, it is often possible to establish cutpoints, allowing for the formation of groups with different probabilities of an event occurring.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="u-shaped-relationship-of-the-predictor-to-hazard-ratio">U-shaped relationship of the predictor to hazard ratio<a class="anchor" aria-label="anchor" href="#u-shaped-relationship-of-the-predictor-to-hazard-ratio"></a>
</h2>
<p>The function <code>cp_est</code> has the argument <code>ushape</code> with two possible characteristics: <code>TRUE</code> or <code>FALSE</code>. If <code>ushape = TRUE</code>, the cutpoints are estimated based on the assumption of a U-shaped or inverted U-shaped relationship between the predictor and the hazard ratio.</p>
<p><code>ushape = TRUE</code> is only achievable when two cutpoints are searched for.</p>
<p>The outer tails belong to the same risk group (lower-, and upper part of Group A), while the midsection constitutes a different risk group (Group B) (see Figure 6). The outer tails must not necessarily be the same size. If they are to be of approximately the same size, the argument <code>symtails</code> has been set to <code>symtails = TRUE</code>.</p>
<p><strong>Example</strong>: Estimate two cutpoints of the variable biomarker under consideration of one covariate:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cp_est.html">cp_est</a></span><span class="op">(</span></span>
<span>  cpvarname    <span class="op">=</span> <span class="st">"biomarker"</span>,</span>
<span>  covariates   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariate_1"</span><span class="op">)</span>,</span>
<span>  data         <span class="op">=</span> <span class="va">data2_ushape</span>,</span>
<span>  nb_of_cp     <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  bandwith     <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  ushape       <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  symtails     <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_splines <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="output-2">Output:<a class="anchor" aria-label="anchor" href="#output-2"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; Approx. remaining time for estimation: 9 seconds </span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; SETTINGS:</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt;  Cutpoint-variable                    =  biomarker </span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt;  Number of cutpoints   (nb_of_cp)     =  2 </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;  Min. group size in %  (bandwith)     =  0.2 </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt;  Estimation type       (est_type)     =  AIC </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;  CP-variable as strata (cpvar_strata) =  FALSE </span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;  Symmetric tails       (symtails)     =  FALSE   (is set to FALSE if nb_of_cp = 1)</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;  Cutpoints for u-shape (ushape)       =  TRUE   (is set to FALSE if nb_of_cp = 1)</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; Covariates or factors are:</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt;   covariate_1 </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; Minimum group size is 40 (20% of sample size in original dataset, N = 200)</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------------</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; Number of cutpoints searching for: 2 </span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt;  1.Cutpoint: biomarker ≤ 1.589527 </span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt;  2.Cutpoint: biomarker ≤ 2.445578 </span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------------------------</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; Group size in relation to valid data of biomarker in original data set</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt;  Total:                N = 200 (100%)</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt;  Group A (lower part): n = 59 (29.5%)</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt;  Group B:              n = 65 (32.5%)</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt;  Group A (upper part): n = 76 (38%)</span></span></code></pre></div>
<p> </p>
<p>If a U-shaped or inverted U-shaped relationship exists, it can be evaluated using the spline plot:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/cp_splines_plot.html">cp_splines_plot</a></span><span class="op">(</span><span class="va">cpobj</span>, show_splines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<figure><img src="reference/figures/cutpoint-package_u-shape_v2.png" alt="Figure 6. U-shaped relationship of the predictor (biomarker) to hazard ratio"><figcaption aria-hidden="true">
Figure 6. U-shaped relationship of the predictor (biomarker) to hazard ratio
</figcaption></figure><p> </p>
<hr>
</div>
<div class="section level3">
<h3 id="help">Help<a class="anchor" aria-label="anchor" href="#help"></a>
</h3>
<p>To report a bug please open an <a href="https://github.com/jan-por/cutpoint/issues/new/choose" class="external-link">issue</a></p>
</div>
<div class="section level3">
<h3 id="suggested-citations">Suggested Citations<a class="anchor" aria-label="anchor" href="#suggested-citations"></a>
</h3>
<p>Porthun, J. (2025). Estimate cutpoints in the multivariable context of survival or time-to-event data. cutpoint R package. Retrieved from <a href="https://github.com/jan-por/cutpoint" class="external-link uri">https://github.com/jan-por/cutpoint</a></p>
<hr>
<p><strong>Jan Porthun</strong> | <a href="https://www.ntnu.edu/employees/jan.porthun" class="external-link">NTNU Norwegian University of Science and Technology</a></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/jan-por/cutpoint/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/jan-por/cutpoint/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://creativecommons.org/licenses/by/4.0" class="external-link">CC BY 4.0</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cutpoint</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jan Porthun <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4100-4361" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Jan Porthun.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
