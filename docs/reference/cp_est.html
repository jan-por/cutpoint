<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate cutpoints in a multivariable setting for survival data — cp_est • cutpoint</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate cutpoints in a multivariable setting for survival data — cp_est"><meta property="og:description" content="One or two cutpoints of a metric variable are estimated using
either the AIC (Akaike Information Criterion) or the LRT
(Likelihood-Ratio Test statistic) within a multivariable Cox proportional
hazards model. These cutpoints are used to create two or three groups with
different survival probabilities.
The cutpoints are estimated by dichotomising the variable of
interest, which is then incorporated into the Cox-regression model. The
cutpoint of this variable is the value at which the AIC reaches its lowest
value or the LRT statistic achieves its maximum for the corresponding
Cox-regression model.
This process occurs within a multivariable framework, as other
covariates and/or factors are considered during the search for the
cutpoints. Cutpoints can also be estimated when the variable of interest
shows a U-shaped or inverse U-shaped relationship to the hazard ratio of
time-to-event data. The argument symtail facilitates the estimation of two
cutpoints, ensuring that the two outer tails represent groups of equal size."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cutpoint</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jan-por/cutpoint/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate cutpoints in a multivariable setting for survival data</h1>
    <small class="dont-index">Source: <a href="https://github.com/jan-por/cutpoint/blob/HEAD/R/cp_est.R" class="external-link"><code>R/cp_est.R</code></a></small>
    <div class="hidden name"><code>cp_est.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>One or two cutpoints of a metric variable are estimated using
either the AIC (Akaike Information Criterion) or the LRT
(Likelihood-Ratio Test statistic) within a multivariable Cox proportional
hazards model. These cutpoints are used to create two or three groups with
different survival probabilities.</p>
<p>The cutpoints are estimated by dichotomising the variable of
interest, which is then incorporated into the Cox-regression model. The
cutpoint of this variable is the value at which the AIC reaches its lowest
value or the LRT statistic achieves its maximum for the corresponding
Cox-regression model.</p>
<p>This process occurs within a multivariable framework, as other
covariates and/or factors are considered during the search for the
cutpoints. Cutpoints can also be estimated when the variable of interest
shows a U-shaped or inverse U-shaped relationship to the hazard ratio of
time-to-event data. The argument <code>symtail</code> facilitates the estimation of two
cutpoints, ensuring that the two outer tails represent groups of equal size.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cp_est</span><span class="op">(</span></span>
<span>  <span class="va">cpvarname</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  event <span class="op">=</span> <span class="st">"event"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  nb_of_cp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bandwith <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  est_type <span class="op">=</span> <span class="st">"AIC"</span>,</span>
<span>  cpvar_strata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ushape <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  symtails <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dp <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  plot_splines <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all_splines <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-cpvarname">cpvarname<a class="anchor" aria-label="anchor" href="#arg-cpvarname"></a></dt>
<dd><p>character, the name of the variable for which the cutpoints
are estimated.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>character, this is the follow-up time.</p></dd>


<dt id="arg-event">event<a class="anchor" aria-label="anchor" href="#arg-event"></a></dt>
<dd><p>character, the status indicator, normally 0=no event, 1=event</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>character vector with the names of the covariates and/ or
factors. If no covariates are used, set <code>covariates = NULL</code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data.frame, contains the following variables:</p><ul><li><p>variable which is dichotomized</p></li>
<li><p>follow-up time</p></li>
<li><p>event (status indicator)</p></li>
<li><p>covariates and/or cofactors</p></li>
</ul></dd>


<dt id="arg-nb-of-cp">nb_of_cp<a class="anchor" aria-label="anchor" href="#arg-nb-of-cp"></a></dt>
<dd><p>numeric, number of cutpoints to be estimated (1 or 2). The
default is: <code>nb_of_cp = 1</code>. The other option is <code>nb_of_cp = 2</code>.</p></dd>


<dt id="arg-bandwith">bandwith<a class="anchor" aria-label="anchor" href="#arg-bandwith"></a></dt>
<dd><p>numeric, minimum group size per group in percent of the total
sample size, <code>bandwith</code> must be between 0.05 and 0.30, default is 0.1
If <code>ushape = TRUE</code>, <code>bandwidth</code> must be at least 0.1.</p></dd>


<dt id="arg-est-type">est_type<a class="anchor" aria-label="anchor" href="#arg-est-type"></a></dt>
<dd><p>character, the method used to estimate the cutpoints. The
default is 'AIC' (Akaike information criterion). The other options is 'LRT'
(likelihood ratio test statistic)</p></dd>


<dt id="arg-cpvar-strata">cpvar_strata<a class="anchor" aria-label="anchor" href="#arg-cpvar-strata"></a></dt>
<dd><p>logical value: if <code>FALSE</code>, The dichotomised variable
serves as covariate in the Cox-regression model for cutpoint determination.
If <code>TRUE</code>, the dichotomised variable is included as a strata in the
Cox-regression model to determine the cutpoint rather than as a covariate.
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-ushape">ushape<a class="anchor" aria-label="anchor" href="#arg-ushape"></a></dt>
<dd><p>logical value: if <code>TRUE</code>, the cutpoints are estimated under the
assumtion that the spline plot shows a U-shaped form or a inverted U-shaped
curve. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-symtails">symtails<a class="anchor" aria-label="anchor" href="#arg-symtails"></a></dt>
<dd><p>logical value: if <code>TRUE</code>, the cutpoints are estimated with
symmetric tails. If <code>nb_of_cp = 1</code>, symtails is set to <code>FALSE</code>. Default is
<code>FALSE</code>.</p></dd>


<dt id="arg-dp">dp<a class="anchor" aria-label="anchor" href="#arg-dp"></a></dt>
<dd><p>numeric, number of decimal places the cutpoints are rounded to.
Default is <code>dp = 2</code>.</p></dd>


<dt id="arg-plot-splines">plot_splines<a class="anchor" aria-label="anchor" href="#arg-plot-splines"></a></dt>
<dd><p>logical value: if <code>TRUE</code>, a penalized spline plot is
created. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-all-splines">all_splines<a class="anchor" aria-label="anchor" href="#arg-all-splines"></a></dt>
<dd><p>logical value: if <code>TRUE</code>, The plot shows splines with
different degrees of freedom. This may help determine whether
misspecification or overfitting occurs. Default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns the <code>cpobj</code> object with cutpoints and the characteristics
of the formed groups.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Govindarajulu, U., &amp; Tarpey, T. (2020). Optimal partitioning for
the proportional hazards model. Journal of Applied Statistics, 49(4),
968–987. https://doi.org/10.1080/02664763.2020.1846690</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="cp_splines_plot.html">cp_splines_plot()</a></code> for penalized spline plots, <code><a href="cp_value_plot.html">cp_value_plot()</a></code>
for Value plots and Index plots</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1:</span></span></span>
<span class="r-in"><span><span class="co"># Estimate two cutpoints of the variable biomarker.</span></span></span>
<span class="r-in"><span><span class="co"># The dataset data1 is included in this package and contains</span></span></span>
<span class="r-in"><span><span class="co"># the variables time, event, biomarker, covariate_1, and covariate_2.</span></span></span>
<span class="r-in"><span><span class="va">cpobj</span> <span class="op">&lt;-</span> <span class="fu">cp_est</span><span class="op">(</span></span></span>
<span class="r-in"><span>  cpvarname  <span class="op">=</span> <span class="st">"biomarker"</span>,</span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariate_1"</span>, <span class="st">"covariate_2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data       <span class="op">=</span> <span class="va">data1</span>,</span></span>
<span class="r-in"><span>  nb_of_cp   <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  plot_splines <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Approx. remaining time for estimation: 7 seconds </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SETTINGS:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Cutpoint-variable                    =  biomarker </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of cutpoints   (nb_of_cp)     =  2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min. group size in %  (bandwith)     =  0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Estimation type       (est_type)     =  AIC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CP-variable as strata (cpvar_strata) =  FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Symmetric tails       (symtails)     =  FALSE   (is set to FALSE if nb_of_cp = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Cutpoints for u-shape (ushape)       =  FALSE   (is set to FALSE if nb_of_cp = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariates or factors are:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   covariate_1 covariate_2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum group size is 10 (10% of sample size in original dataset, N = 100)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of cutpoints searching for: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.Cutpoint: biomarker ≤ 89 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.Cutpoint: biomarker ≤ 137 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group size in relation to valid data of biomarker in original data set</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Total:   N = 100 (100%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Group A: n = 12 (12%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Group B: n = 17 (17%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Group C: n = 71 (71%)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2:</span></span></span>
<span class="r-in"><span><span class="co"># Searching for cutpoints, if the variable shows a U-shaped or</span></span></span>
<span class="r-in"><span><span class="co"># inverted U-shaped relationship to the hazard ratio.</span></span></span>
<span class="r-in"><span><span class="co"># The dataset data2_ushape is included in this package and contains</span></span></span>
<span class="r-in"><span><span class="co"># the variables time, event, biomarker, and cutpoint_1.</span></span></span>
<span class="r-in"><span><span class="va">cpobj</span> <span class="op">&lt;-</span> <span class="fu">cp_est</span><span class="op">(</span></span></span>
<span class="r-in"><span>  cpvarname  <span class="op">=</span> <span class="st">"biomarker"</span>,</span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covariate_1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data       <span class="op">=</span> <span class="va">data2_ushape</span>,</span></span>
<span class="r-in"><span>  nb_of_cp   <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  bandwith   <span class="op">=</span> <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>  ushape     <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  plot_splines <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Approx. remaining time for estimation: 9 seconds </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SETTINGS:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Cutpoint-variable                    =  biomarker </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of cutpoints   (nb_of_cp)     =  2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min. group size in %  (bandwith)     =  0.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Estimation type       (est_type)     =  AIC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CP-variable as strata (cpvar_strata) =  FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Symmetric tails       (symtails)     =  FALSE   (is set to FALSE if nb_of_cp = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Cutpoints for u-shape (ushape)       =  TRUE   (is set to FALSE if nb_of_cp = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariates or factors are:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   covariate_1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum group size is 40 (20% of sample size in original dataset, N = 200)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of cutpoints searching for: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.Cutpoint: biomarker ≤ 1.589527 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.Cutpoint: biomarker ≤ 2.445578 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group size in relation to valid data of biomarker in original data set</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Total:                N = 200 (100%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Group A (lower part): n = 59 (29.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Group B:              n = 65 (32.5%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Group A (upper part): n = 76 (38%)</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan Porthun.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

